<!doctype html><html lang=en-us><head><meta name=generator content="Hugo 0.120.4"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Support for open source cheminformatics toolkits is coming! </title><meta name=description content="A rundown of coming changes and improvements in the openforcefield toolkit."><meta name=author content="John Chodera"><meta property="og:title" content="Support for open source cheminformatics toolkits is coming!"><meta property="og:description" content="A rundown of coming changes and improvements in the openforcefield toolkit."><meta property="og:type" content="article"><meta property="og:url" content="https://asapdiscovery.org/news/rdkit-support-is-coming/"><meta property="article:section" content="news"><meta property="article:published_time" content="2018-09-30T00:00:00+00:00"><meta property="article:modified_time" content="2018-09-30T00:00:00+00:00"><div id=cookie-notice><span>We would like to use third party cookies and scripts to improve the
functionality of this website.</span>
<a id=cookie-notice-accept class="btn btn-primary btn-sm">Approve</a>
<a id=cookie-notice-deny class="btn btn-primary btn-sm">Deny</a>
<a href=/privacy class="btn btn-primary btn-sm">More info</a></div><script>function createCookie(e,t,n){var s,o="";n&&(s=new Date,s.setTime(s.getTime()+n*24*60*60*1e3),o="; expires="+s.toUTCString()),document.cookie=e+"="+t+o+"; path=/"}function readCookie(e){for(var t,s=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(t=o[n];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(s)==0)return t.substring(s.length,t.length)}return null}function eraseCookie(e){createCookie(e,"",-1)}if(readCookie("cookie-notice-option")=="true"){function loadScriptAsync(e,t){if(typeof t!="function")throw new Error("Not a valid callback for async script load");var n=document.createElement("script");n.onload=t,n.src=e,document.head.appendChild(n)}loadScriptAsync("https://www.googletagmanager.com/gtag/js?id=G-M3L857X90H",function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date),e("config","G-M3L857X90H",{anonymize_ip:!0})})}else readCookie("cookie-notice-option")!="false"&&(document.getElementById("cookie-notice").style.display="block");document.getElementById("cookie-notice-accept").addEventListener("click",function(){createCookie("cookie-notice-option","true",31),document.getElementById("cookie-notice").style.display="none",location.reload()}),document.getElementById("cookie-notice-deny").addEventListener("click",function(){createCookie("cookie-notice-option","false",31),document.getElementById("cookie-notice").style.display="none",location.reload()})</script><link rel=canonical href=https://asapdiscovery.org/news/rdkit-support-is-coming/><link rel="shortcut icon" type=image/png href="data:image/png;base64,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OIhEI585YOOg9MdW/j/H/wHPYXLfRc591AAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0wOS0yN1QxOTo1NDo0NSswMDowMIDoSlsAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMDktMjdUMTk6NTQ6NDUrMDA6MDDxtfLnAAAARnRFWHRzb2Z0d2FyZQBJbWFnZU1hZ2ljayA2LjcuOC05IDIwMTQtMDUtMTIgUTE2IGh0dHA6Ly93d3cuaW1hZ2VtYWdpY2sub3Jn3IbtAAAAABh0RVh0VGh1bWI6OkRvY3VtZW50OjpQYWdlcwAxp/+7LwAAABh0RVh0VGh1bWI6OkltYWdlOjpoZWlnaHQAMTkyDwByhQAAABd0RVh0VGh1bWI6OkltYWdlOjpXaWR0aAAxOTLTrCEIAAAAGXRFWHRUaHVtYjo6TWltZXR5cGUAaW1hZ2UvcG5nP7JWTgAAABd0RVh0VGh1bWI6Ok1UaW1lADE1MzgwNzgwODVJxYBaAAAAD3RFWHRUaHVtYjo6U2l6ZQAwQkKUoj7sAAAAVnRFWHRUaHVtYjo6VVJJAGZpbGU6Ly8vbW50bG9nL2Zhdmljb25zLzIwMTgtMDktMjcvMTMzYjc5NWY2OTU4ZjNiZTAwOTA3MzM0OGI4YTQ3NDAuaWNvLnBuZ+0QeFYAAAAASUVORK5CYII="><link href=/css/font.css rel=stylesheet type=text/css><link href=/css/kube.css rel=stylesheet type=text/css><link href=/css/kube.legenda.css rel=stylesheet type=text/css><link href=/css/highlight.css rel=stylesheet type=text/css><link href=/css/master.css rel=stylesheet type=text/css><link href=/css/kube.demo.css rel=stylesheet type=text/css><link href=/css/custom.css rel=stylesheet type=text/css><script src=/js/jquery-2.1.4.min.js type=text/javascript></script><script type=text/javascript src=/js/tocbot.min.js></script></head><body class=page-kube><header><div class=show-sm><div id=nav-toggle-box><div id=nav-toggle-brand><a href=/>ASAP Discovery Consortium</a></div><a data-component=toggleme data-target=#top href=# id=nav-toggle><i class=kube-menu></i></a></div></div><div class=hide-sm id=top><div id=top-brand><a href=/ title=home>ASAP Discovery Consortium</a></div><nav id=top-nav-main><ul><li><a href=/pipeline/>Pipeline</a></li><li><a href=/outputs/>Outputs</a></li><li><a href=https://www.choderalab.org/news/2021/10/26/asap-avidd-proposal>Concept</a></li><li><a href=/members/>Members</a></li><li><a href=/sab/>SAB</a></li><li><a href=/faq/>FAQ</a></li><li><a href=/forum/>Open Science Forum</a></li><li><a href=https://postera.ai/moonshot/>COVID Moonshot</a></li></ul></nav><nav id=top-nav-extra><ul></ul></nav></div></header><main><div class=push-center itemscope itemtype=http://schema.org/BlogPosting><meta itemprop=name content="Support for open source cheminformatics toolkits is coming!"><meta itemprop=description content="A rundown of coming changes and improvements in the openforcefield toolkit."><meta itemprop=datePublished content="2018-09-30T00:00:00+00:00"><meta itemprop=dateModified content="2018-09-30T00:00:00+00:00"><meta itemprop=wordCount content="1188"><meta itemprop=keywords content="openforcefield toolkit,cheminformatics toolkits,SMIRNOFF,"><div id=hero><h1 itemprop=headline>Support for open source cheminformatics toolkits is coming!</h1><blockquote itemprop=description>A rundown of coming changes and improvements in the openforcefield toolkit.</blockquote><time class=post-time><span class=icon><i class="fa fa-clock-o" aria-hidden=true></i>
</span><span>6 minute read,</span>
<span class=icon><i class="fa fa-pencil" aria-hidden=true></i>
</span>Published: <time datetime=2018-09-30T00:00:00+00:00>30 Sep, 2018</time></time></div><div id=post-box><div id=post itemprop=articleBody><p>We&rsquo;ve been hard at work with a large-scale infrastructure overhaul of our main <a href=http://github.com/openforcefield/openforcefield>openforcefield toolkit</a> following the <a href=https://github.com/openforcefield/openforcefield/releases/tag/0.1.0>Open Force Field Toolkit 0.1.0 prerelease</a>, which provided an initial reference implementation of the <a href=https://doi.org/10.1101/286542>SMIRNOFF 0.1 specification</a> for direct chemical perception.
Many thanks to all the users who provided helpful feedback in how we could improve overall usability!</p><p>While we expect the updated toolkit to be released very soon, we wanted to provide a summary of the coming changes to give you an idea of what we&rsquo;ve been up to:</p><h3 id=support-for-fully-open-source-cheminformatics-toolkits>Support for fully open source cheminformatics toolkits
<a href=#support-for-fully-open-source-cheminformatics-toolkits><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-link" viewBox="0 0 16 16"><path d="M6.354 5.5H4a3 3 0 000 6h3a3 3 0 002.83-4H9c-.086.0-.17.01-.25.031A2 2 0 017 10.5H4a2 2 0 110-4h1.535c.218-.376.495-.714.82-1z"/><path d="M9 5.5a3 3 0 00-2.83 4h1.098A2 2 0 019 6.5h3a2 2 0 110 4h-1.535a4.02 4.02.0 01-.82 1H12a3 3 0 100-6H9z"/></svg></a></h3><p>While the <a href=https://github.com/openforcefield/openforcefield/releases/tag/0.1.0>Toolkit 0.1.0 prerelease</a> required the <a href=https://docs.eyesopen.com/toolkits/python/index.html>OpenEye Toolkits</a> to provide facilities for molecule reading/writing, chemical perception via SMARTS, conformer generation, and partial charge assignment, we have been working hard to allow fully open cheminformatics toolkits (such as <a href=http://www.rdkit.org/>The RDKit</a>) to be easily used instead.</p><p>We are introducing <a href=https://open-forcefield-toolkit.readthedocs.io/en/topology/utils.html#toolkit-wrappers>Toolkit Wrappers</a>, which provide a simple, unified API to multiple toolkits to expose the cheminformatics features required by the openforcefield toolkit.</p><p>These features include:</p><ul><li>Reading and writing molecules from standard file formats (Tripos mol2, SDF, PDB, etc.)</li><li>Conversion to/from SMILES strings</li><li>Enumeration of tagged-atom SMARTS (SMIRKS) matches within chemical structures</li><li>Partial charge assignment with corrected semiempirical charge assignments (e.g. AM1-BCC)</li></ul><p>Initially, we are adding support for the following toolkits:</p><ul><li>The <a href=https://docs.eyesopen.com/toolkits/python/index.html>OpenEye Toolkit</a> will continue to be supported, though a <a href=https://www.eyesopen.com/pricing>license</a> is required for their use</li><li>The <a href=http://www.rdkit.org>RDKit</a>, which provides support for molecule reading/writing, conversion to/from SMILES, and SMARTS matching, but does not provide AM1-BCC charge assignment capabilities</li><li>The <a href=http://ambermd.org/AmberTools.php>AmberTools</a> for assigning AM1 and AM1-BCC charges via <code>sqm</code></li></ul><p>Initially, this means that the RDKit and AmberTools together can provide complete functionality for assignment of <a href=https://open-forcefield-toolkit.readthedocs.io/en/0.2.0/smirnoff.html>SMIRNOFF</a> parameters for small molecules.
We will include automatic installation of both of these toolkits as part of the next <code>conda</code> release of the openforcefield toolkit.</p><h3 id=a-new-draft-smirnoff-10-specification>A new draft SMIRNOFF 1.0 specification
<a href=#a-new-draft-smirnoff-10-specification><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-link" viewBox="0 0 16 16"><path d="M6.354 5.5H4a3 3 0 000 6h3a3 3 0 002.83-4H9c-.086.0-.17.01-.25.031A2 2 0 017 10.5H4a2 2 0 110-4h1.535c.218-.376.495-.714.82-1z"/><path d="M9 5.5a3 3 0 00-2.83 4h1.098A2 2 0 019 6.5h3a2 2 0 110 4h-1.535a4.02 4.02.0 01-.82 1H12a3 3 0 100-6H9z"/></svg></a></h3><p>While the <a href=https://doi.org/10.1101/286542>SMIRNOFF 0.1 specification</a> was a significant step forward in automated chemical perception based force fields, it was incomplete and inconsistent in some ways that would hinder its growth.
This release will include a new backwards-incompatible <a href=https://open-forcefield-toolkit.readthedocs.io/en/0.2.0/smirnoff.html>draft SMIRNOFF 1.0 specification</a> that will support rapid improvements in force field accuracy over the next year, featuring multiple improvements:</p><ul><li>Aromaticity model now defaults to <code>OEAroModel_MDL</code>, and aromaticity model names drop OpenEye-specific prefixes</li><li>Top-level tags are now required to specify units for any unit-bearing quantities to avoid the potential for mistakes from implied units.</li><li>Potential energy component definitions were renamed to be more general:<ul><li><code>&lt;NonbondedForce></code> was renamed to <code>&lt;vdW></code></li><li><code>&lt;HarmonicBondForce></code> was renamed to <code>&lt;Bonds></code></li><li><code>&lt;HarmonicAngleForce></code> was renamed to <code>&lt;Angles></code></li><li><code>&lt;BondChargeCorrections></code> was renamed to <code>&lt;ChargeIncrementModel></code> and generalized to accommodate an arbitrary number of tagged atoms</li><li><code>&lt;GBSAForce></code> was renamed to <code>&lt;GBSA></code></li></ul></li><li><code>&lt;PeriodicTorsionForce></code> was split into <code>&lt;ProperTorsions></code> and <code>&lt;ImproperTorsions></code></li><li><code>&lt;vdW></code> now specifies 1-2, 1-3, and 1-4 scaling factors via <code>scale12</code> (default: 0), <code>scale13</code> (default: 0), and <code>scale14</code> (default: 0.5) attributes. Coulomb scaling parameters have been removed from <code>StericsForce</code>.</li><li>Added the <code>&lt;Electrostatics></code> tag to separately specify 1-2, 1-3, and 1-4 scaling factors for electrostatics, as well as the method used to compute electrostatics (<code>PME</code>, <code>reaction-field</code>, <code>Coulomb</code>) since this has a huge effect on the energetics of the system.</li><li>Made it clear that <code>&lt;Constraint></code> entries do not have to be between bonded atoms.</li><li><code>&lt;VirtualSites></code> has been added, and the specification of charge increments harmonized with <code>&lt;ChargeIncrementModel></code></li><li>The <code>potential</code> attribute was added to most forces to allow flexibility in extending forces to additional functional forms (or algebraic expressions) in the future. <code>potential</code> defaults to the current recommended scheme if omitted.</li><li><code>&lt;GBSA></code> now has defaults specified for <code>gb_method</code> and <code>sa_method</code></li><li>Changes to how fractional bond orders are handled:<ul><li>Use of fractional bond order is now are specified at the force tag level, rather than the root level</li><li>The fractional bond order method is specified via the <code>fractional_bondorder_method</code> attribute</li><li>The fractional bond order interpolation scheme is specified via the <code>fractional_bondorder_interpolation</code></li></ul></li><li>Section heading names were cleaned up.</li><li>Example was updated to reflect use of the new <code>openforcefield.topology.Topology</code> class</li><li>Eliminated &ldquo;Requirements&rdquo; section, since it specified requirements for the software, rather than described an aspect of the SMIRNOFF specification</li><li>Fractional bond orders are described in <code>&lt;Bonds></code>, since they currently only apply to this term.</li></ul><p>The current draft SMIRNOFF 1.0 specification can be found here: <a href=https://open-forcefield-toolkit.readthedocs.io/en/0.2.0/smirnoff.html>Draft SMIRNOFF 1.0 specification</a></p><h3 id=new-openforcefield-molecule-and-topology-objects>New openforcefield <code>Molecule</code> and <code>Topology</code> objects
<a href=#new-openforcefield-molecule-and-topology-objects><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-link" viewBox="0 0 16 16"><path d="M6.354 5.5H4a3 3 0 000 6h3a3 3 0 002.83-4H9c-.086.0-.17.01-.25.031A2 2 0 017 10.5H4a2 2 0 110-4h1.535c.218-.376.495-.714.82-1z"/><path d="M9 5.5a3 3 0 00-2.83 4h1.098A2 2 0 019 6.5h3a2 2 0 110 4h-1.535a4.02 4.02.0 01-.82 1H12a3 3 0 100-6H9z"/></svg></a></h3><p>Specifying the system to parameterize with <a href=https://open-forcefield-toolkit.readthedocs.io/en/0.2.0/smirnoff.html>SMIRNOFF</a> previously required passing along a set of OpenEye Toolkit <a href=https://docs.eyesopen.com/toolkits/python/oechemtk/OEChemClasses/OEMol.html><code>OEMol</code></a> objects.
To support the migration toward broader support for fully open source toolkits, we have introduced two new classes intended to aid the reading and manipulation of biomolecular systems for parameterization:</p><ul><li><a href=https://open-forcefield-toolkit.readthedocs.io/en/topology/topology.html#molecule><code>Molecule</code></a>: A simple pure Python class for manipulating molecules and interconverting with different toolkits</li><li><a href=https://open-forcefield-toolkit.readthedocs.io/en/topology/topology.html#topology><code>Topology</code></a>: A simple pure Python class for manipulating collections of molecules to simplify application of parameters</li></ul><p>These classes aim to simplify reading chemical descriptions of systems from several popular formats to generate parameterized molecular systems.
For example, to read small molecule from an RDKit <code>rdmol</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#888># Create an openforcefield Molecule object from an RDKit Mol molecule</span>
</span></span><span style=display:flex><span>molecule <span style=color:#333>=</span> Molecule<span style=color:#333>.</span>from_rdkit(rdmol)
</span></span></code></pre></div><p>or from a file</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#888># Create an openforcefield Molecule object from a Tripos mol2 file using whatever toolkit(s) are available</span>
</span></span><span style=display:flex><span><span style=color:#080;font-weight:700>from</span> <span style=color:#0e84b5;font-weight:700>openforcefield.topology</span> <span style=color:#080;font-weight:700>import</span> Molecule
</span></span><span style=display:flex><span>molecule <span style=color:#333>=</span> Molecule<span style=color:#333>.</span>from_file(mol2_filename)
</span></span></code></pre></div><p>Creating a <code>Topology</code> object from one or more <code>Molecule</code> objects is easy:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#888># Create an openforcefield Topology object consisting of a single openforcefield Molecule</span>
</span></span><span style=display:flex><span><span style=color:#080;font-weight:700>from</span> <span style=color:#0e84b5;font-weight:700>openforcefield.topology</span> <span style=color:#080;font-weight:700>import</span> Topology
</span></span><span style=display:flex><span>topology <span style=color:#333>=</span> Topology<span style=color:#333>.</span>from_molecules(molecule)
</span></span></code></pre></div><p>While we have not yet added biomolecular force fields in SMIRNOFF format, reading of PDB files containing small molecules will also be straightforward if your small molecules is also available (with any atom ordering) in some format that can be read from a file (such as a Tripos mol2 file):</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#888># Create an openforcefield Topology object from a PDB file and Tripos mol2 files defining each component of the PDB file</span>
</span></span><span style=display:flex><span><span style=color:#080;font-weight:700>from</span> <span style=color:#0e84b5;font-weight:700>simtk.openmm</span> <span style=color:#080;font-weight:700>import</span> app
</span></span><span style=display:flex><span>pdbfile <span style=color:#333>=</span> app<span style=color:#333>.</span>PDBFile(pdb_filename)
</span></span><span style=display:flex><span>unique_molecules <span style=color:#333>=</span> [ Molecule<span style=color:#333>.</span>from_file(mol2_filename) <span style=color:#080;font-weight:700>for</span> mol2_filename <span style=color:#000;font-weight:700>in</span> mol2_filenames ]
</span></span><span style=display:flex><span>topology <span style=color:#333>=</span> Topology<span style=color:#333>.</span>from_openmm(pdbfile<span style=color:#333>.</span>topology, unique_molecules<span style=color:#333>=</span>unique_molecules)
</span></span></code></pre></div><p>Soon, <code>Molecule</code> and <code>Topology</code> will also support serialization to a standard that will make data interchange for biomolecular systems easier.</p><h3 id=a-new-smirnoff-reference-implementation-forcefield-api>A new SMIRNOFF reference implementation (<code>ForceField</code>) API
<a href=#a-new-smirnoff-reference-implementation-forcefield-api><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-link" viewBox="0 0 16 16"><path d="M6.354 5.5H4a3 3 0 000 6h3a3 3 0 002.83-4H9c-.086.0-.17.01-.25.031A2 2 0 017 10.5H4a2 2 0 110-4h1.535c.218-.376.495-.714.82-1z"/><path d="M9 5.5a3 3 0 00-2.83 4h1.098A2 2 0 019 6.5h3a2 2 0 110 4h-1.535a4.02 4.02.0 01-.82 1H12a3 3 0 100-6H9z"/></svg></a></h3><p>The original SMIRNOFF 0.1 reference implementation (<code>openforcefield.typing.engines.ForceField</code>) followed the OpenMM <code>simtk.openmm.app.ForceField</code> API very closely.
As we seek to make the toolkit less OpenMM-centric and easier to use with various molecular simulation packages directly, we have refined its API to make this process easier, in addition to conforming with Python PEP8 naming standards.</p><p>Generation of parameterized OpenMM <code>System</code> objects is still easy:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#888># Create an OpenMM System object from the openforcefield Topology object</span>
</span></span><span style=display:flex><span><span style=color:#080;font-weight:700>from</span> <span style=color:#0e84b5;font-weight:700>openforcefield.typing.engines</span> <span style=color:#080;font-weight:700>import</span> ForceField
</span></span><span style=display:flex><span>forcefield <span style=color:#333>=</span> ForceField(<span style=background-color:#fff0f0>&#39;smirnoff99frosst&#39;</span>)
</span></span><span style=display:flex><span>openmm_system <span style=color:#333>=</span> forcefield<span style=color:#333>.</span>create_openmm_system(topology)
</span></span></code></pre></div><p>but now you will also be able to create input files for other packages easily via <a href=http://github.com/parmed/parmed>ParmEd</a> (which will also be automatically installed with the <code>conda</code> package):</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#888># Generate a ParmEd Structure object from the openforcefield Topology object, attaching positions</span>
</span></span><span style=display:flex><span>parmed_structure <span style=color:#333>=</span> forcefield<span style=color:#333>.</span>create_parmed_structure(topology, positions)
</span></span><span style=display:flex><span><span style=color:#888># Write AMBER input files</span>
</span></span><span style=display:flex><span>parmed_structure<span style=color:#333>.</span>save(<span style=background-color:#fff0f0>&#39;amber.inpcrd&#39;</span>)
</span></span><span style=display:flex><span>parmed_structure<span style=color:#333>.</span>save(<span style=background-color:#fff0f0>&#39;amber.prmtop&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#888># Write gromacs input files</span>
</span></span><span style=display:flex><span>parmed_structure<span style=color:#333>.</span>save(<span style=background-color:#fff0f0>&#39;gromacs.gro&#39;</span>)
</span></span><span style=display:flex><span>parmed_structure<span style=color:#333>.</span>save(<span style=background-color:#fff0f0>&#39;gromacs.top&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#888># Write CHARMM input files</span>
</span></span><span style=display:flex><span>parmed_structure<span style=color:#333>.</span>save(<span style=background-color:#fff0f0>&#39;charmm.psf&#39;</span>)
</span></span><span style=display:flex><span>parmed_structure<span style=color:#333>.</span>save(<span style=background-color:#fff0f0>&#39;charmm.crd&#39;</span>)
</span></span></code></pre></div><h3 id=improved-toolkit-documentation-and-examples>Improved toolkit documentation and examples
<a href=#improved-toolkit-documentation-and-examples><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-link" viewBox="0 0 16 16"><path d="M6.354 5.5H4a3 3 0 000 6h3a3 3 0 002.83-4H9c-.086.0-.17.01-.25.031A2 2 0 017 10.5H4a2 2 0 110-4h1.535c.218-.376.495-.714.82-1z"/><path d="M9 5.5a3 3 0 00-2.83 4h1.098A2 2 0 019 6.5h3a2 2 0 110 4h-1.535a4.02 4.02.0 01-.82 1H12a3 3 0 100-6H9z"/></svg></a></h3><p>A preview of the updated toolkit documentation can be found <a href=https://open-forcefield-toolkit.readthedocs.io/en/0.2.0>here</a>.
Throughout the documentation, numerous examples are provided to make it easy for users to simply copy-and-paste simple solutions to common tasks.</p></div><div><p>Published
by <span itemprop=author>John Chodera</span>
<time datetime=2018-09-30T00:00:00+00:00>30 Sep, 2018
</time>in <span itemprop=articleSection>&lt;a href="/categories/news/">news&lt;/a></span>
and tagged &lt;a href="/tags/cheminformatics-toolkits/">cheminformatics toolkits&lt;/a>, &lt;a href="/tags/openforcefield-toolkit/">openforcefield toolkit&lt;/a> and &lt;a href="/tags/smirnoff/">SMIRNOFF&lt;/a>
using <span itemprop=wordCount>1188</span> words.</p><aside><heade><strong>Related Content</strong></header><hr><ul><li><a href=/news/openforcefield-toolkit-0.5-release/>The Open Force Field Toolkit 0.5.0, adding GBSA support</a> &ndash; 3 minutes<li><a href=/news/openforcefield-toolkit-0.2-release/>The 0.2.0 Toolkit release, now with RDKit support!</a> &ndash; 5 minutes</ul></aside></div></div></div></main><footer><footer id=footer><nav><ul><li><span>ASAP Discovery</span></li><li><a href=/concept>About Us</a></li><li><a href=/credits>Image Credits</a></li><li><a href=mailto:maggie.jameson@choderalab.org>Contact Us</a></li></ul></nav></footer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css integrity=sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0 crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js integrity=sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1 crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js integrity=sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx crossorigin=anonymous></script><script>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]});for(var inlineMathArray=document.querySelectorAll("script[type='math/tex']"),inlineMath,tex,replaced,displayMath,i=0;i<inlineMathArray.length;i++)inlineMath=inlineMathArray[i],tex=inlineMath.innerText||inlineMath.textContent,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex,{displayMode:!1}),inlineMath.parentNode.replaceChild(replaced,inlineMath);for(displayMathArray=document.querySelectorAll("script[type='math/tex; mode=display']"),i=0;i<displayMathArray.length;i++)displayMath=displayMathArray[i],tex=displayMath.innerHTML,replaced=document.createElement("span"),replaced.innerHTML=katex.renderToString(tex.replace(/%.*/g,""),{displayMode:!0}),displayMath.parentNode.replaceChild(replaced,displayMath)</script><script>renderMathInElement(document.body)</script></footer><script src=/js/kube.js type=text/javascript></script><script src=/js/kube.legenda.js type=text/javascript></script><script src=/js/master.js type=text/javascript></script></body></html>